#!/usr/bin/env node

const { program } = require('commander');
const rpcCommand = require('../src/commands/rpc');
const scanCommand = require('../src/commands/scan');
const reportCommand = require('../src/commands/report');
const holdersCommand = require('../src/commands/holders');
const txCommand = require('../src/commands/tx');
const watchCommand = require('../src/commands/watch');

program
  .name('tokenctl')
  .description('Solana token snapshot CLI utility')
  .version('1.0.0');

program
  .command('rpc')
  .description('Check RPC endpoint health')
  .option('--rpc <url>', 'RPC endpoint URL')
  .action(rpcCommand);

program
  .command('scan <mint>')
  .description('Full token snapshot')
  .option('--rpc <url>', 'RPC endpoint URL')
  .option('--sig-limit <number>', 'Number of signatures to fetch for activity', '10')
  .option('--holders', 'Include holder distribution (heavy operation)')
  .option('--max-accounts <number>', 'Maximum accounts to scan for holders', '5000')
  .action(scanCommand);

program
  .command('report <mint>')
  .description('Compact Telegram-friendly report')
  .option('--rpc <url>', 'RPC endpoint URL')
  .option('--max-accounts <number>', 'Maximum accounts to scan', '5000')
  .action(reportCommand);

program
  .command('holders <mint>')
  .description('Token holder distribution')
  .option('--rpc <url>', 'RPC endpoint URL')
  .option('--top <number>', 'Number of top holders to show', '10')
  .option('--list', 'List top account addresses')
  .option('--max-accounts <number>', 'Maximum accounts to scan', '5000')
  .action(holdersCommand);

program
  .command('tx <mint>')
  .description('Recent transaction activity')
  .option('--rpc <url>', 'RPC endpoint URL')
  .option('--limit <number>', 'Number of signatures to fetch', '10')
  .option('--hours <number>', 'Hours to look back', '24')
  .option('--accounts <number>', 'Number of largest token accounts to scan', '8')
  .option('--show <number>', 'Number of events to display', '10')
  .action(txCommand);

program
  .command('watch <mint>')
  .description('Live monitoring with alerts')
  .option('--rpc <url>', 'RPC endpoint URL')
  .option('--interval <seconds>', 'Polling interval in seconds', '30')
  .option('--transfer-threshold <number>', 'Large transfer threshold', '1000000')
  .option('--mint-threshold <number>', 'Mint event threshold', '1000000')
  .action(watchCommand);

program.parse();

